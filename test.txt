Debug镜像Dockerfile

FROM golang:alpine as grpcurl
RUN apk update \
  && apk add --virtual build-dependencies git \
  && apk add bash curl jq \
  && go get -u github.com/fullstorydev/grpcurl \
  && go install github.com/fullstorydev/grpcurl/cmd/grpcurl@latest

FROM alpine:latest
RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories && \
    apk update && \
    apk add --no-cache vim bash tcpdump curl wget strace mysql-client iproute2 redis jq iftop tzdata tar nmap bind-tools htop && \
    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
RUN wget -O /usr/bin/httpstat https://github.com/davecheney/httpstat/releases/download/v1.0.0/httpstat-linux-amd64-v1.0.0 && \
    chmod +x /usr/bin/httpstat
COPY --from=grpcurl  /go/bin/grpcurl /usr/bin/grpcurl
ENV TZ=Asia/Shanghai LC_ALL=C.UTF-8 LANG=C.UTF-8 LANGUAGE=C.UTF-8
ENTRYPOINT [ "/bin/bash" ]




######利用nsenter进入容器网络名称空间
function netcheck() {
  set -eu
  ns=${2-"default"}
  pod=`kubectl -n $ns describe pod $1 | grep -A10 "^Containers:" | grep -Eo 'docker://.*$' | head -n 1 | sed 's/docker:\/\/\(.*\)$/\1/'`
  pid=`docker inspect -f {{.State.Pid}} $pod`
  echo "entering pod netns for $ns/$1"
  cmd="nsenter -n --target $pid"
  echo $cmd
  $cmd
 }

netcheck nginx-98f85fbb8-ql2gv 
===
entering pod netns for default/nginx-98f85fbb8-ql2gv
nsenter -n --target 4536
====

grep gitment-editor-login -rl --include=\*.{ejs,js} /home/cs/oss/hexo/themes/spfk


var isMobile = {
  Android: function () {
    return navigator.userAgent.match(/Android/i);
  },
  BlackBerry: function () {
    return navigator.userAgent.match(/BlackBerry/i);
  },
  iOS: function () {
    return navigator.userAgent.match(/iPhone|iPad|iPod/i);
  },
  Opera: function () {
    return navigator.userAgent.match(/Opera Mini/i);
  },
  Windows: function () {
    return navigator.userAgent.match(/IEMobile/i);
  },
  any: function () {
    return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
  }
};

if ($('.local-search').size() && !isMobile.any()) {
  $.getScript('path/to/search.js', function() {
    searchFunc("/search.xml", 'local-search-input', 'local-search-result');
  });
}






/home/cs/oss/hexo/themes/spfk/layout/_partial/after-footer.ejs
<link rel="stylesheet" href="<%- config.root %>css/animate.min.css">
      <%- css('//cdn.bootcss.com/animate.css/3.5.0/animate.min.css') %>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/">
busuanzi?jsonpCallback=BusuanziCallback_718359423750

grep algoliasearch -rl --include=\*.{ejs,js} /home/cs/oss/hexo/themes/spfk/layout/
grep animate.min.css -rl --include=\*.{ejs,js} /home/cs/oss/hexo/themes/spfk

/home/cs/oss/hexo/themes/spfk/layout/_partial/post-nav-button.ejs
/home/cs/oss/hexo/themes/spfk/layout/_partial/hide-labels.ejs
/home/cs/oss/hexo/themes/spfk/layout/_partial/page.ejs
cs@debian:~/oss/hexo/themes/spfk$ 

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  <script type="text/javascript"
     src="<%- config.root %>js/Mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

待确定是否使用
/home/cs/oss/hexo/themes/spfk/source/js/jquery/

搜索
/home/cs/oss/hexo/themes/spfk/source/js/search.js
/home/cs/oss/hexo/themes/spfk/layout/_partial/after-footer.ejs

